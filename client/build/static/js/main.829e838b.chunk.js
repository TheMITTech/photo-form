(this["webpackJsonptech-photo-form"]=this["webpackJsonptech-photo-form"]||[]).push([[0],{166:function(e,t,a){},256:function(e,t,a){},282:function(e,t,a){"use strict";a.r(t);var o=a(0),n=a.n(o),c=a(27),l=a.n(c),s=(a(166),a(158)),i=a(47),r=a(37),u=(a.p,a(114)),j=a.n(u),d=j.a.create({baseURL:"https://photo-form.thetech.com"}),b=a(290),m=a(288),f=a(287),h=a(159),O=a(286),p=a(55),v=a(289),x=a(292),g=a(293),I=a(291),T=a(6),w=b.a.Title;b.a.Paragraph,b.a.Text,b.a.Link;function P(e){var t=e.photoData;return Object(T.jsxs)("div",{children:[Object(T.jsx)("img",{src:t.download_url,style:{maxWidth:"100%"}}),Object(T.jsxs)("p",{children:["Uploader: ",t.uploader," ",Object(T.jsx)("br",{}),"Attribution: ",t.attribution," ",Object(T.jsx)("br",{}),"Department: ",t.department," ",Object(T.jsx)("br",{}),"Date Taken: ",t.dt_taken," ",Object(T.jsx)("br",{}),"Caption: ",t.caption," ",Object(T.jsx)("br",{})]})]})}function k(e){var t=Object(o.useState)([]),a=Object(r.a)(t,2),n=a[0],c=a[1],l=Object(o.useState)([]),s=Object(r.a)(l,2),i=s[0],u=s[1],j=Object(o.useState)([]),m=Object(r.a)(j,2),f=m[0],O=m[1];if(Object(o.useEffect)((function(){c(!1),console.log("got default volume ".concat(e.defaultVolume," and issue ").concat(e.defaultIssue)),O({volume:e.defaultVolume,issue:e.defaultIssue})}),[]),Object(o.useEffect)((function(){n&&d.get("photos_by_issue",{params:{volume:f.volume,issue:f.issue}}).then((function(e){return u(e)}))}),[n,f]),!n)return Object(T.jsx)("div",{className:"main-container",children:Object(T.jsx)(v.a,{name:"viewer-password",onFinish:function(e){"techphoto"==e.password?c(!0):h.b.error("Incorrect Password")},children:Object(T.jsx)(v.a.Item,{label:"Password",name:"password",children:Object(T.jsx)(x.a.Password,{})})})});if(i.data&&i.data.length>0)var k=i.data.map((function(e){return Object(T.jsx)(P,{photoData:e})}));else k=Object(T.jsx)("p",{children:"No Photos"});return Object(T.jsxs)("div",{className:"main-container",children:[Object(T.jsx)(b.a,{children:Object(T.jsxs)(w,{children:["Photos for Volume ",f.volume," Issue"," ",f.issue]})}),Object(T.jsx)("h1",{}),Object(T.jsxs)(v.a,{name:"select_issue",onFinish:function(e){O({volume:e.volume?e.volume:f.volume,issue:e.issue?e.issue:f.issue})},children:[Object(T.jsx)("h2",{children:"Choose new issue"}),Object(T.jsxs)(g.b,{children:[Object(T.jsx)(v.a.Item,{label:"Volume",name:"volume",children:Object(T.jsx)(I.a,{defaultValue:f.volume})}),Object(T.jsx)(v.a.Item,{label:"Issue",name:"issue",children:Object(T.jsx)(I.a,{defaultValue:f.issue})}),Object(T.jsx)(v.a.Item,{children:Object(T.jsx)(p.a,{type:"primary",htmlType:"submit",children:"Go"})})]})]}),k]})}a(256);var V=a(103),S=a.n(V),y=a(154),D=(a(143),Object(y.b)(S.a)),C=a(156),N=(a(283),Object(C.a)(S.a),o.forwardRef((function(e,t){return Object(T.jsx)(D,Object(i.a)(Object(i.a)({},e),{},{picker:"time",mode:void 0,ref:t}))})));N.displayName="TimePicker";var _=a(116),F=a.n(_),E=a(104),L=a(117),U=b.a.Title,R=(b.a.Paragraph,b.a.Text,b.a.Link,L.a.Option);function J(e){var t=v.a.useForm(),a=Object(r.a)(t,1)[0],o=E(e.imgInfo.date);return console.log(o),console.log(E("2019-11-10T03:53:31-05:00")),Object(T.jsxs)("div",{className:"image-info-form-container",children:[Object(T.jsx)(O.a,{}),Object(T.jsxs)(U,{level:2,children:["Image ",e.itemNum,": ",e.file.name]}),Object(T.jsx)("img",{src:URL.createObjectURL(e.file),className:"image-preview"}),Object(T.jsxs)(v.a,{form:a,onFieldsChange:function(t,a){var n=function(t){return{event_name:t[0].value,department:t[1].value?t[1].value:"fto",volume:t[2].value?t[2].value:e.defaultVolume,issue:t[3].value?t[3].value:e.defaultIssue,dt_taken:t[4].value?t[4].value:o,caption:t[5].value,attribution:t[6].value}}(a);e.handleUpdate(n)},children:[Object(T.jsx)(v.a.Item,{label:"Event/Topic",name:"event",children:Object(T.jsx)(x.a,{placeholder:"Men's Soccer vs. WPI"})}),Object(T.jsxs)(g.b,{children:[Object(T.jsx)(v.a.Item,{label:"Department",name:"department",children:Object(T.jsxs)(L.a,{placeholder:"Select",defaultValue:"fto",children:[Object(T.jsx)(R,{value:"spo",children:"SPO"}),Object(T.jsx)(R,{value:"fto",children:"FTO"}),Object(T.jsx)(R,{value:"rtz",children:"RTZ"}),Object(T.jsx)(R,{value:"cl",children:"CL"})]})}),Object(T.jsx)(v.a.Item,{label:"Volume",name:"volume",children:Object(T.jsx)(I.a,{defaultValue:e.defaultVolume})}),Object(T.jsx)(v.a.Item,{label:"Issue",name:"issue",children:Object(T.jsx)(I.a,{defaultValue:e.defaultIssue})})]}),Object(T.jsx)(v.a.Item,{label:"Date/Time Taken (autofilled from EXIF if available)",name:"datetime",children:Object(T.jsx)(D,{defaultValue:o.isValid()?o:void 0,showTime:!0,disabled:o.isValid()},o)}),Object(T.jsx)(v.a.Item,{label:"Caption",name:"caption",children:Object(T.jsx)(x.a.TextArea,{placeholder:"See the wiki for how to write a good caption"})}),Object(T.jsx)(v.a.Item,{label:"Attribution (or your full name)",name:"attribution",children:Object(T.jsx)(x.a,{placeholder:"Photo Provided by Dance Troupe"})})]})]})}function A(e){var t=Object(o.useState)({}),a=Object(r.a)(t,2),n=(a[0],a[1],Object(o.useState)(null)),c=Object(r.a)(n,2),l=c[0],s=c[1];return Object(o.useEffect)((function(){F.a.getData(e.file,(function(){var e=F.a.getTag(this,"DateTimeOriginal");s(void 0!==e?function(e){var t=e.split(/\D/);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])}(e):null)}))}),[e.file]),Object(T.jsx)(J,Object(i.a)(Object(i.a)({},e),{},{imgInfo:{date:l}}))}var K=b.a.Title,z=b.a.Paragraph,B=(b.a.Text,b.a.Link,m.a.Dragger);function G(e){var t=Object(o.useState)([]),a=Object(r.a)(t,2),n=a[0],c=a[1],l=Object(o.useState)([]),u=Object(r.a)(l,2),j=u[0],m=u[1];var f=n.map((function(t,a){return Object(T.jsx)(A,{file:t.file,itemNum:a+1,defaultVolume:e.defaultVolume,defaultIssue:e.defaultIssue,handleUpdate:function(e){console.log("Saw update to form in item ".concat(a+1,": ").concat(JSON.stringify(e)));var t=Object(s.a)(n);t[a].info=e,c(t)}},a)}));return Object(T.jsxs)("div",{className:"photo-form",children:[Object(T.jsxs)(b.a,{children:[Object(T.jsx)(K,{children:"The Tech Photo Upload Form"}),Object(T.jsx)(z,{children:"This site is meant to make the process of uploading photos simpler."})]}),Object(T.jsx)(M,{addPhotos:function(e){var t=e.map((function(e){return{file:e,info:{}}}));c(n.concat(t))},handleKerbChange:function(e){m(e)}}),f,Object(T.jsx)(O.a,{}),Object(T.jsx)(p.a,{type:"primary",onClick:function(){console.log("submitted photo list to follow"),console.log(n);var e=n.map((function(e,t){return Object(i.a)(Object(i.a)({},e.info),{},{uploader:j,filename:e.file.name})}));console.log(e),e.forEach((function(e,t){var a="uploading_msg";h.b.loading({content:"Uploading Photo ".concat(t+1,"/").concat(n.length),msg_key:a}),d.post("create_photo",e).then((function(e){console.log("post result"),console.log(e);var o=new FormData;for(var l in e.data.upload_url.fields)o.append(l,e.data.upload_url.fields[l]);o.append("file",n[t].file),d.post(e.data.upload_url.url,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log("upload result"),console.log(e),h.b.success({content:"Done uploading!",msg_key:a})})),c([])}))}))},children:"Submit ".concat(n.length," Photo").concat(1!=n.length?"s":"")})]})}function M(e){return Object(T.jsx)("div",{className:"photo-selector",children:Object(T.jsxs)(v.a,{children:[Object(T.jsx)(v.a.Item,{label:"Your Kerberos",children:Object(T.jsx)(x.a,{placeholder:"kerb",rules:[{required:!0}],onChange:function(t){e.handleKerbChange(t.target.value)}})}),Object(T.jsx)(v.a.Item,{children:Object(T.jsx)(B,{name:"file",accept:"image/png, image/jpeg",multiple:!0,showUploadList:!1,beforeUpload:function(t,a){return e.addPhotos(a),!1},children:"Drag or click to upload files. Please upload JPEG files."})})]})})}var W=function(){var e=Object(o.useState)([]),t=Object(r.a)(e,2),a=t[0],n=t[1];Object(o.useEffect)((function(){n("form")}),[]);var c=Object(o.useState)([]),l=Object(r.a)(c,2),s=l[0],i=l[1];return Object(o.useEffect)((function(){d.get("photos",{params:{skip:0,limit:1}}).then((function(e){0!=e.data.length?(console.log(e),i({volume:e.data[0].volume,issue:e.data[0].issue}),console.log("got most recent volume and issue"),console.log(e.data[0].volume),console.log(e.data[0].issue)):i({volume:void 0,issue:void 0})}))}),[]),"form"==a?Object(T.jsxs)("div",{className:"main-container",children:[Object(T.jsx)(G,{defaultVolume:s.volume,defaultIssue:s.issue}),Object(T.jsx)("br",{}),Object(T.jsx)("a",{style:{opacity:"25%"},onClick:function(){n("view"),console.log("clicked"),console.log(a)},children:"view all photos"})]}):"view"==a?Object(T.jsx)("div",{className:"main-container",children:Object(T.jsx)(k,{defaultVolume:s.volume,defaultIssue:s.issue})}):Object(T.jsx)("div",{className:"main-container",children:Object(T.jsx)(f.a,{size:"large"})})},q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,294)).then((function(t){var a=t.getCLS,o=t.getFID,n=t.getFCP,c=t.getLCP,l=t.getTTFB;a(e),o(e),n(e),c(e),l(e)}))};l.a.render(Object(T.jsx)(n.a.StrictMode,{children:Object(T.jsx)(W,{})}),document.getElementById("root")),q()}},[[282,1,2]]]);
//# sourceMappingURL=main.829e838b.chunk.js.map